<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport"
            content="width=divice-width, user-scalable=no, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatable" content="ie=edge">
        <link rel="stylesheet" href="css/ajax-blog.css">
    </head>
    <body>
      <header class="container">
        <h1>Weather Application</h1>
        <h2>San Antonio</h2>
      </header>
      <main class="container">
        <div id="forecasts" class="row-64">
          <div class="column col-33">
            <div>
              <span>@high</span><span>/</span><span>@low</span>
            </div>
            <div>@cloud-icon</div>
            <div>
              <span>Clouds:</span>@clouds
            </div>
            <div>
              <span>Wind:</span><span>@wind</span>
            </div>
            <div>
              <span>Pressure:</span><span>@pressure</span>
            </div>
          </div>
          <div class="column col-33">
            <div>
              <span>@high</span><span>/</span><span>@low</span>
            </div>
            <div>@cloud-icon</div>
            <div>
              <span>Clouds:</span>@clouds
            </div>
            <div>
              <span>Wind:</span><span>@wind</span>
            </div>
            <div>
              <span>Pressure:</span><span>@pressure</span>
            </div>
          </div>
          <div class="column col-33">
            <div>
              <span>@high</span><span>/</span><span>@low</span>
            </div>
            <div>@cloud-icon</div>
            <div>
              <span>Clouds:</span>@clouds
            </div>
            <div>
              <span>Wind:</span><span>@wind</span>
            </div>
            <div>
              <span>Pressure:</span><span>@pressure</span>
            </div>
          </div>
        </div>
      </main>

        <script src="node_modules/jquery/dist/jquery.js"></script>
        <script>
          "use strict";

          function kelvinToCelsius(k){
            console.assert(!isNaN(k));  // fail if not number
            return (k - 273.15).toFixed(2);
          }

          function kelvinToFahrenheit(k){
            console.assert(!isNaN(k));  // fail if not number
            return ( ((k * 9) / 5) - 459.67).toFixed(2);
          }

          function forecastTempToHtml(ave, hi, lo){
            return "\taverage: " + ave + "\thigh: " + hi + "\tlow: " + lo;
          }

          function forecastWindToHtml(speed, degree){
            return "" + speed + " " + degree;
          }

          function forecastAirToHtml(humidity, pressure){
            return "" + humidity + " " + pressure;
          }

          function forecastCloudtoHtml(count, descript, icon){
            return "" + count + " " + descript + " " + icon;
          }

          function forecastToHtml(forecast, card){
            console.assert(typeof(forecast) == "object");
            console.assert(index == 1 || index == 2 || index == 3);


            // console.log(
            //   forecastCloudtoHtml(
            //     forecast.clouds.all,
            //     forecast.weather[0].description,
            //     forecast.weather[0].icon)
            //   );
            // console.log(
            //   forecastAirToHtml(
            //     forecast.main.humidity,
            //     forecast.main.pressure)
            //   );
            // console.log(
            //   forecastTempToHtml(
            //     forecast.main.temp,
            //     forecast.main.temp_max,
            //     forecast.main.temp_min)
            //   );
            // console.log(
            //   forecastWindToHtml(forecast.wind.speed, forecast.wind.deg)
            // );
          }

          function getWeatherData(){
            $.get("http://api.openweathermap.org/data/2.5/forecast", {
              APPID: "195919dfceeead3386ee0ea3acf5490b",
              q:     "San Antonio, US"
            }).done(function(data, status) {
              console.log(data);
              var forecasts = [];

              // push an element for each day into forecasts
              for(var i = 0; i < data.list.length; i+=8){
                //console.log(forecasts.length + "\t" + data.list[i]);
                forecasts.push(data.list[i]);
                if(forecasts.length == 3){
                  break;
                }
              }

              var cards = $("#forecasts").children();
              for(var i = 0; i < 3; i++){
                forecastToHtml(forecasts[i], cards[i]);
              }

            }).fail(function(status, error){
              console.log("Request failed on: " + status +
                "\nData received: " + error);
            });
          }
        </script>
    </body>
</html>
